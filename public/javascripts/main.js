var toast = new Toasty(options);
errors.forEach(error => {
   toast.error(error)
});
successes.forEach(success => {
   toast.success(success)
});
function stripHtml(html) {
   let tmp = document.createElement("DIV");
   tmp.innerHTML = html;
   return tmp.textContent || tmp.innerText || "";
}

// on succeeds on pages with `editor` and `html-output` and other inputs
try {
   const editor = pell.init({
      element: document.getElementById('editor'),
      onChange: html => {
         document.getElementById('html-output').textContent = html
         var raw = stripHtml(html)
         var charactersLeft = 200 - raw.length;
         var count = document.getElementById('characters-left');
         count.innerHTML = "Characters left: " + charactersLeft;
         document.querySelectorAll('.add#description')[0].value = (html)

      },
      classes: {
         actionbar: 'pell-actionbar',
         button: 'pell-button',
         content: 'pell-content',
         selected: 'pell-button-selected'
      }
   })
   // editor.content<HTMLElement>
   // To change the editor's content:
   editor.content.innerHTML = '<b><u><i>Initial content!</i></u></b>'
} catch (error) {
   console.log("Probably running where pen is not in HTML | ERROR: ", error.message)
}


// The DOM element you wish to replace with Tagify
var inputTags = document.querySelector('input[name=tags]');

// initialize Tagify on the above input node reference
new Tagify(inputTags, {
   pattern: /^.{0,20}$/,  // Validate typed tag(s) by Regex. Here maximum chars length is defined as "10"
   delimiters: ",| ",        // add new tags when a comma or a space character is entered
   keepInvalidTags: false,         // do not remove invalid tags (but keep them marked as invalid)
   editTags: {
      clicks: 1,              // single click to edit a tag
      keepInvalid: true      // if after editing, tag is invalid, auto-revert
   },
   maxTags: 3,
   whitelist: ["temple", "stun", "detective"],
   transformTag: transformTag,
   backspace: "edit",
   placeholder: "Type something",
   dropdown: {
      enabled: 1,            // show suggestion after 1 typed character
      fuzzySearch: true,    // match only suggestions that starts with the typed characters
      position: 'text',      // position suggestions list next to typed text
      caseSensitive: true,   // allow adding duplicate items if their case is different
   },
   templates: {
      dropdownItemNoMatch: function (data) {
         return `
            No suggestion found for: ${data.value}
        `
      }
   }
})

function transformTag(tagData) {
   tagData.style = "--tag-bg:" + stringToColour(tagData.value);
}

function stringToColour(str) {
   var hash = 0;
   for (var i = 0; i < str.length; i++) {
      hash = str.charCodeAt(i) + ((hash << 5) - hash);
   }
   var colour = '#';
   for (var i = 0; i < 3; i++) {
      var value = (hash >> (i * 8)) & 0xFF;
      colour += ('00' + value.toString(16)).substr(-2);
   }
   return colour;
}

var options = {
   classname: "toast",
   transition: "fade",
   insertBefore: true,
   duration: 4000,
   enableSounds: true,
   autoClose: false,
   progressBar: true,
   sounds: {
      info: "../sounds/info/1.mp3",
      success: "../sounds/success/1.mp3",
      warning: "../sounds/warning/1.mp3",
      error: "../sounds/error/1.mp3",
   },

   onShow: function (type) { },

   onHide: function (type) { },

   prependTo: document.body.childNodes[0]
};

// credits: https://github.com/turban/Leaflet.Mask
// credits: https://github.com/turban/Leaflet.Mask
// credits: https://github.com/turban/Leaflet.Mask
// credits: https://github.com/turban/Leaflet.Mask
L.Mask = L.Polygon.extend({
   options: {
      stroke: false,
      color: '#333',
      fillOpacity: 0.5,
      clickable: true,

      outerBounds: new L.LatLngBounds([-90, -360], [90, 360])
   },

   initialize: function (latLngs, options) {

      var outerBoundsLatLngs = [
         this.options.outerBounds.getSouthWest(),
         this.options.outerBounds.getNorthWest(),
         this.options.outerBounds.getNorthEast(),
         this.options.outerBounds.getSouthEast()
      ];
      L.Polygon.prototype.initialize.call(this, [outerBoundsLatLngs, latLngs], options);
   },

});
L.mask = function (latLngs, options) {
   return new L.Mask(latLngs, options);
};



// Polygon created with http://geojson.io/
var dz = {
   "type": "FeatureCollection",
   "features": [
      {
         "type": "Feature",
         "properties": {

         },
         "geometry": {
            "type": "Polygon",
            "coordinates": [
               [
                  [
                     8.640747070312498,
                     36.9367208722872
                  ],
                  [
                     8.448486328125,
                     36.89719446989036
                  ],
                  [
                     8.360595703125,
                     36.91915611148194
                  ],
                  [
                     8.28369140625,
                     36.90597988519294
                  ],
                  [
                     8.2177734375,
                     36.94550173495345
                  ],
                  [
                     8.0364990234375,
                     36.8708321556463
                  ],
                  [
                     7.882690429687501,
                     36.83566824724438
                  ],
                  [
                     7.745361328125,
                     36.88401445049676
                  ],
                  [
                     7.767333984374999,
                     36.94989178681327
                  ],
                  [
                     7.613525390624999,
                     36.954281585675965
                  ],
                  [
                     7.503662109375,
                     37.02448395075965
                  ],
                  [
                     7.393798828125,
                     37.04202441635081
                  ],
                  [
                     7.261962890625,
                     37.06394430056685
                  ],
                  [
                     7.2015380859375,
                     37.06394430056685
                  ],
                  [
                     7.250976562499999,
                     37.01132594307015
                  ],
                  [
                     7.18505859375,
                     36.92793899776678
                  ],
                  [
                     7.03125,
                     36.90597988519294
                  ],
                  [
                     6.9378662109375,
                     36.87962060502676
                  ],
                  [
                     6.8389892578125,
                     36.954281585675965
                  ],
                  [
                     6.734619140625,
                     36.94550173495345
                  ],
                  [
                     6.5643310546875,
                     36.96744946416934
                  ],
                  [
                     6.520385742187499,
                     37.04202441635081
                  ],
                  [
                     6.39404296875,
                     37.077093191754436
                  ],
                  [
                     6.300659179687499,
                     37.02886944696474
                  ],
                  [
                     6.218261718749999,
                     36.98500309285596
                  ],
                  [
                     6.278686523437499,
                     36.9367208722872
                  ],
                  [
                     6.207275390625,
                     36.914764288955936
                  ],
                  [
                     6.0699462890625,
                     36.8708321556463
                  ],
                  [
                     5.888671875,
                     36.82247761166621
                  ],
                  [
                     5.7623291015625,
                     36.81368259124586
                  ],
                  [
                     5.7073974609375,
                     36.83127162140714
                  ],
                  [
                     5.64697265625,
                     36.76969233214548
                  ],
                  [
                     5.5810546875,
                     36.76529191711624
                  ],
                  [
                     5.5426025390625,
                     36.721273880045004
                  ],
                  [
                     5.38330078125,
                     36.65079252503471
                  ],
                  [
                     5.2294921875,
                     36.65079252503471
                  ],
                  [
                     5.114135742187499,
                     36.681636065615216
                  ],
                  [
                     5.064697265625,
                     36.72567681977065
                  ],
                  [
                     5.108642578125,
                     36.787291466820015
                  ],
                  [
                     4.993286132812499,
                     36.81368259124586
                  ],
                  [
                     4.8504638671875,
                     36.85325222344018
                  ],
                  [
                     4.74609375,
                     36.88840804313823
                  ],
                  [
                     4.5703125,
                     36.87522650673951
                  ],
                  [
                     4.4329833984375,
                     36.91915611148194
                  ],
                  [
                     4.3890380859375,
                     36.89280138293983
                  ],
                  [
                     4.251708984375,
                     36.910372213522535
                  ],
                  [
                     4.1033935546875,
                     36.901587303978474
                  ],
                  [
                     3.9385986328125,
                     36.90597988519294
                  ],
                  [
                     3.8507080078125004,
                     36.90597988519294
                  ],
                  [
                     3.7847900390624996,
                     36.88840804313823
                  ],
                  [
                     3.7023925781249996,
                     36.8708321556463
                  ],
                  [
                     3.6474609374999996,
                     36.83127162140714
                  ],
                  [
                     3.482666015625,
                     36.778492404594154
                  ],
                  [
                     3.4222412109375,
                     36.778492404594154
                  ],
                  [
                     3.3013916015624996,
                     36.787291466820015
                  ],
                  [
                     3.2464599609375,
                     36.804886560237236
                  ],
                  [
                     3.1695556640624996,
                     36.73888412439431
                  ],
                  [
                     3.0706787109375,
                     36.756490329505176
                  ],
                  [
                     3.0596923828124996,
                     36.80928470205937
                  ],
                  [
                     2.9388427734374996,
                     36.804886560237236
                  ],
                  [
                     2.8784179687499996,
                     36.77409249464195
                  ],
                  [
                     2.8289794921874996,
                     36.721273880045004
                  ],
                  [
                     2.7575683593749996,
                     36.681636065615216
                  ],
                  [
                     2.6477050781249996,
                     36.61111838494165
                  ],
                  [
                     2.559814453125,
                     36.58465761247169
                  ],
                  [
                     2.4169921874999996,
                     36.589068371399115
                  ],
                  [
                     2.373046875,
                     36.63316209558658
                  ],
                  [
                     2.2906494140625,
                     36.65079252503471
                  ],
                  [
                     2.1807861328125,
                     36.619936625629215
                  ],
                  [
                     2.0159912109375,
                     36.589068371399115
                  ],
                  [
                     1.9116210937499998,
                     36.5670120564234
                  ],
                  [
                     1.7358398437499998,
                     36.56260003738545
                  ],
                  [
                     1.5655517578125,
                     36.527294814546245
                  ],
                  [
                     1.4501953125,
                     36.527294814546245
                  ],
                  [
                     1.34033203125,
                     36.53612263184686
                  ],
                  [
                     1.285400390625,
                     36.50963615733049
                  ],
                  [
                     1.1590576171875,
                     36.50963615733049
                  ],
                  [
                     1.0491943359375,
                     36.47872381162464
                  ],
                  [
                     0.9558105468749999,
                     36.45221769643571
                  ],
                  [
                     0.9063720703124999,
                     36.41244153535644
                  ],
                  [
                     0.8404541015624999,
                     36.36822190085111
                  ],
                  [
                     0.714111328125,
                     36.35052700542763
                  ],
                  [
                     0.6317138671874999,
                     36.319551259461186
                  ],
                  [
                     0.516357421875,
                     36.24870331653198
                  ],
                  [
                     0.4449462890625,
                     36.217687122250574
                  ],
                  [
                     0.3076171875,
                     36.16448788632064
                  ],
                  [
                     0.19775390625,
                     36.08462129606931
                  ],
                  [
                     0.1263427734375,
                     36.01800375871416
                  ],
                  [
                     0.0384521484375,
                     35.88905007936091
                  ],
                  [
                     -0.054931640625,
                     35.80444911191491
                  ],
                  [
                     -0.1812744140625,
                     35.79553849799263
                  ],
                  [
                     -0.3515625,
                     35.84008157153468
                  ],
                  [
                     -0.3955078125,
                     35.90684930677121
                  ],
                  [
                     -0.472412109375,
                     35.88014896488361
                  ],
                  [
                     -0.538330078125,
                     35.755428369259626
                  ],
                  [
                     -0.6921386718749999,
                     35.72421761691415
                  ],
                  [
                     -0.8184814453125,
                     35.755428369259626
                  ],
                  [
                     -0.9173583984375001,
                     35.71083783530009
                  ],
                  [
                     -1.0382080078125,
                     35.64390523787731
                  ],
                  [
                     -1.16455078125,
                     35.576916524038616
                  ],
                  [
                     -1.23046875,
                     35.44277092585766
                  ],
                  [
                     -1.2799072265625,
                     35.357696204467516
                  ],
                  [
                     -1.4007568359375,
                     35.285984736065764
                  ],
                  [
                     -1.51611328125,
                     35.263561862152095
                  ],
                  [
                     -1.636962890625,
                     35.19625600786368
                  ],
                  [
                     -1.7083740234375,
                     35.15135442846945
                  ],
                  [
                     -2.0379638671875,
                     35.05698043137265
                  ],
                  [
                     -2.164306640625,
                     35.074964853989556
                  ],
                  [
                     -2.208251953125,
                     35.043489514314686
                  ],
                  [
                     -2.13134765625,
                     34.9805024453652
                  ],
                  [
                     -2.054443359375,
                     34.92647493584645
                  ],
                  [
                     -1.9830322265624998,
                     34.93097858831627
                  ],
                  [
                     -1.9830322265624998,
                     34.858890491257796
                  ],
                  [
                     -1.9061279296875,
                     34.831841149828655
                  ],
                  [
                     -1.8182373046875,
                     34.78222760653013
                  ],
                  [
                     -1.746826171875,
                     34.74161249883172
                  ],
                  [
                     -1.8402099609375,
                     34.6241677899049
                  ],
                  [
                     -1.746826171875,
                     34.511083202999714
                  ],
                  [
                     -1.6864013671875,
                     34.488447837809304
                  ],
                  [
                     -1.7852783203125,
                     34.38877925439021
                  ],
                  [
                     -1.7138671875,
                     34.29353023058858
                  ],
                  [
                     -1.7083740234375,
                     34.23905366851639
                  ],
                  [
                     -1.658935546875,
                     34.102707993174874
                  ],
                  [
                     -1.702880859375,
                     33.865854454071865
                  ],
                  [
                     -1.6644287109375,
                     33.747180448149855
                  ],
                  [
                     -1.7138671875,
                     33.68321092658007
                  ],
                  [
                     -1.6534423828125,
                     33.669496972795535
                  ],
                  [
                     -1.60400390625,
                     33.6008944080788
                  ],
                  [
                     -1.60400390625,
                     33.50475906922609
                  ],
                  [
                     -1.6534423828125,
                     33.38099943104024
                  ],
                  [
                     -1.669921875,
                     33.280027811732154
                  ],
                  [
                     -1.5435791015625,
                     33.109948297894285
                  ],
                  [
                     -1.461181640625,
                     33.03629817885956
                  ],
                  [
                     -1.505126953125,
                     32.94875863715422
                  ],
                  [
                     -1.5435791015625,
                     32.95797741405952
                  ],
                  [
                     -1.40625,
                     32.73646168396554
                  ],
                  [
                     -1.2634277343749998,
                     32.66250035467838
                  ],
                  [
                     -1.131591796875,
                     32.57459172113418
                  ],
                  [
                     -1.0272216796875,
                     32.505129231918936
                  ],
                  [
                     -1.175537109375,
                     32.338200271527754
                  ],
                  [
                     -1.285400390625,
                     32.20815332547324
                  ],
                  [
                     -1.29638671875,
                     32.14771106595571
                  ],
                  [
                     -1.1480712890624998,
                     32.11980111179328
                  ],
                  [
                     -1.351318359375,
                     32.0732655510424
                  ],
                  [
                     -1.6314697265625,
                     32.11980111179328
                  ],
                  [
                     -1.878662109375,
                     32.13840869677249
                  ],
                  [
                     -1.966552734375,
                     32.16631295696736
                  ],
                  [
                     -2.1588134765625,
                     32.12910537866883
                  ],
                  [
                     -2.2247314453125,
                     32.15236189465577
                  ],
                  [
                     -2.3016357421875,
                     32.12445336381827
                  ],
                  [
                     -2.5213623046875,
                     32.15236189465577
                  ],
                  [
                     -2.61474609375,
                     32.10584293285769
                  ],
                  [
                     -2.9278564453125,
                     32.11049589629439
                  ],
                  [
                     -2.900390625,
                     32.00341778396365
                  ],
                  [
                     -2.8399658203125,
                     31.83089906339438
                  ],
                  [
                     -2.8619384765625,
                     31.774877618507386
                  ],
                  [
                     -3.31787109375,
                     31.70947636001935
                  ],
                  [
                     -3.658447265625,
                     31.62999849900255
                  ],
                  [
                     -3.6529541015625,
                     31.405223877581317
                  ],
                  [
                     -3.7628173828124996,
                     31.320794146937374
                  ],
                  [
                     -3.7683105468749996,
                     31.123496964067325
                  ],
                  [
                     -3.5540771484375,
                     31.015278981711266
                  ],
                  [
                     -3.69140625,
                     30.812628584773705
                  ],
                  [
                     -3.8452148437499996,
                     30.60482195075795
                  ],
                  [
                     -4.306640625,
                     30.53387657299763
                  ],
                  [
                     -4.63623046875,
                     30.26381184075493
                  ],
                  [
                     -5.108642578125,
                     30.002516938570686
                  ],
                  [
                     -5.284423828125,
                     29.888280933159265
                  ],
                  [
                     -5.3338623046875,
                     29.778681776917633
                  ],
                  [
                     -5.5316162109375,
                     29.587788659909958
                  ],
                  [
                     -5.592041015625,
                     29.463514026304715
                  ],
                  [
                     -5.6744384765625,
                     29.52567042617583
                  ],
                  [
                     -5.745849609375,
                     29.52567042617583
                  ],
                  [
                     -5.718383789062499,
                     29.578234494739206
                  ],
                  [
                     -5.7733154296875,
                     29.57345707301757
                  ],
                  [
                     -5.91064453125,
                     29.506549442788593
                  ],
                  [
                     -6.031494140625,
                     29.506549442788593
                  ],
                  [
                     -6.17431640625,
                     29.47307903155816
                  ],
                  [
                     -6.3885498046875,
                     29.511330027309146
                  ],
                  [
                     -6.6851806640625,
                     29.506549442788593
                  ],
                  [
                     -6.767578125,
                     29.477861195816843
                  ],
                  [
                     -6.9927978515625,
                     29.49698759653577
                  ],
                  [
                     -7.1136474609375,
                     29.516110386062277
                  ],
                  [
                     -7.250976562499999,
                     29.482643134466617
                  ],
                  [
                     -7.3333740234375,
                     29.3965337391284
                  ],
                  [
                     -7.4981689453125,
                     29.36302703778376
                  ],
                  [
                     -7.6080322265625,
                     29.372601506681402
                  ],
                  [
                     -7.640991210937501,
                     29.30077105450428
                  ],
                  [
                     -7.9541015625,
                     29.156958511360703
                  ],
                  [
                     -8.1683349609375,
                     29.008140362978157
                  ],
                  [
                     -8.4429931640625,
                     28.810986808864513
                  ],
                  [
                     -8.668212890625,
                     28.70986084394286
                  ],
                  [
                     -8.6737060546875,
                     27.327855149448382
                  ],
                  [
                     -5.91064453125,
                     25.656382025768067
                  ],
                  [
                     -2.7301025390625,
                     23.664650731631614
                  ],
                  [
                     -0.54931640625,
                     22.243344409235693
                  ],
                  [
                     1.1590576171875,
                     21.115249309963783
                  ],
                  [
                     1.1810302734375,
                     20.725290873994197
                  ],
                  [
                     1.318359375,
                     20.745840238902257
                  ],
                  [
                     1.3897705078125,
                     20.65848618804128
                  ],
                  [
                     1.6534423828125,
                     20.52993312517078
                  ],
                  [
                     1.7742919921875,
                     20.31887233939871
                  ],
                  [
                     1.878662109375,
                     20.287961155077717
                  ],
                  [
                     1.9226074218749998,
                     20.236428815882984
                  ],
                  [
                     2.1697998046875,
                     20.287961155077717
                  ],
                  [
                     2.3016357421875,
                     20.257043804632385
                  ],
                  [
                     2.39501953125,
                     20.122997556207757
                  ],
                  [
                     2.384033203125,
                     20.030128899024707
                  ],
                  [
                     2.4554443359375,
                     20.081729389971592
                  ],
                  [
                     2.581787109375,
                     20.045610827439717
                  ],
                  [
                     2.6751708984375,
                     20.092047451277185
                  ],
                  [
                     2.7575683593749996,
                     19.988836302380797
                  ],
                  [
                     2.955322265625,
                     19.9526963975442
                  ],
                  [
                     3.262939453125,
                     19.833892782537767
                  ],
                  [
                     3.2464599609375,
                     19.699485994162497
                  ],
                  [
                     3.251953125,
                     19.61671792534097
                  ],
                  [
                     3.2354736328125,
                     19.564966221479995
                  ],
                  [
                     3.262939453125,
                     19.52355289169168
                  ],
                  [
                     3.251953125,
                     19.435514339097825
                  ],
                  [
                     3.18603515625,
                     19.362976133341846
                  ],
                  [
                     3.197021484375,
                     19.285220799977402
                  ],
                  [
                     3.1201171874999996,
                     19.16592425362802
                  ],
                  [
                     3.31787109375,
                     18.984220415249744
                  ],
                  [
                     3.3782958984375,
                     18.95824648598139
                  ],
                  [
                     5.789794921875,
                     19.445874298215937
                  ],
                  [
                     7.476196289062499,
                     20.863944849076905
                  ],
                  [
                     11.997070312499998,
                     23.528736617422013
                  ],
                  [
                     11.590576171875,
                     24.261989400796306
                  ],
                  [
                     11.4202880859375,
                     24.20187936928663
                  ],
                  [
                     11.013793945312498,
                     24.452150156180966
                  ],
                  [
                     10.832519531249998,
                     24.56211235799689
                  ],
                  [
                     10.7666015625,
                     24.5271348225978
                  ],
                  [
                     10.711669921874998,
                     24.56710835257599
                  ],
                  [
                     10.579833984375,
                     24.53712939907993
                  ],
                  [
                     10.3436279296875,
                     24.532132210302738
                  ],
                  [
                     10.0140380859375,
                     24.996015742094006
                  ],
                  [
                     10.0140380859375,
                     25.3688458240828
                  ],
                  [
                     9.404296875,
                     26.199805575765804
                  ],
                  [
                     9.503173828125,
                     26.386948928734135
                  ],
                  [
                     9.865722656249998,
                     26.52956523826758
                  ],
                  [
                     9.920654296875,
                     26.64745870265938
                  ],
                  [
                     9.898681640625,
                     26.735799020431674
                  ],
                  [
                     9.920654296875,
                     26.86328062676624
                  ],
                  [
                     9.810791015625,
                     27.142256704793976
                  ],
                  [
                     9.788818359374998,
                     27.352252938063845
                  ],
                  [
                     9.8712158203125,
                     27.556981920338316
                  ],
                  [
                     9.82177734375,
                     27.566721430409707
                  ],
                  [
                     9.920654296875,
                     27.659203644307926
                  ],
                  [
                     9.964599609375,
                     27.86336037597851
                  ],
                  [
                     9.964599609375,
                     27.8651814778059
                  ],
                  [
                     9.963226318359373,
                     27.888246118437756
                  ],
                  [
                     9.935073852539062,
                     27.966507842687804
                  ],
                  [
                     9.898681640625,
                     28.082885345939868
                  ],
                  [
                     9.858856201171875,
                     28.208818788396872
                  ],
                  [
                     9.832763671875,
                     28.297125824492902
                  ],
                  [
                     9.90142822265625,
                     28.76043607174582
                  ],
                  [
                     9.8602294921875,
                     29.065772888415406
                  ],
                  [
                     9.775085449218748,
                     29.422852691411045
                  ],
                  [
                     9.54437255859375,
                     29.90256760730233
                  ],
                  [
                     9.415283203125,
                     30.04532159026885
                  ],
                  [
                     9.393310546875,
                     30.17599895913958
                  ],
                  [
                     9.44549560546875,
                     30.192618218499273
                  ],
                  [
                     9.5635986328125,
                     30.232967599863763
                  ],
                  [
                     9.06646728515625,
                     32.098863043145876
                  ],
                  [
                     8.360595703125,
                     32.50281289041497
                  ],
                  [
                     8.316650390625,
                     32.8219030154127
                  ],
                  [
                     8.07769775390625,
                     33.06622597514673
                  ],
                  [
                     8.118896484375,
                     33.098444531367186
                  ],
                  [
                     8.0584716796875,
                     33.10304621868762
                  ],
                  [
                     7.882690429687501,
                     33.18353672893615
                  ],
                  [
                     7.83050537109375,
                     33.17664043594348
                  ],
                  [
                     7.748107910156249,
                     33.24557893338554
                  ],
                  [
                     7.7398681640625,
                     33.426856918285004
                  ],
                  [
                     7.59429931640625,
                     33.648921941686545
                  ],
                  [
                     7.6025390625,
                     33.687781758439364
                  ],
                  [
                     7.566833496093749,
                     33.73804486328907
                  ],
                  [
                     7.586059570312499,
                     33.75174787568194
                  ],
                  [
                     7.52838134765625,
                     33.799691173251084
                  ],
                  [
                     7.54486083984375,
                     33.8362013852728
                  ],
                  [
                     7.522888183593749,
                     33.902336404480685
                  ],
                  [
                     7.547607421875,
                     33.93880275084578
                  ],
                  [
                     7.550354003906251,
                     34.023071367612125
                  ],
                  [
                     7.522888183593749,
                     34.064036693555465
                  ],
                  [
                     7.60528564453125,
                     34.10725639663118
                  ],
                  [
                     7.6080322265625,
                     34.10725639663118
                  ],
                  [
                     7.640991210937501,
                     34.17999758688084
                  ],
                  [
                     7.794799804687499,
                     34.21180215769026
                  ],
                  [
                     7.8662109375,
                     34.35704160076073
                  ],
                  [
                     7.8607177734375,
                     34.4069096565206
                  ],
                  [
                     8.0364990234375,
                     34.465806327688526
                  ],
                  [
                     8.1298828125,
                     34.52466147177172
                  ],
                  [
                     8.2122802734375,
                     34.58347505599177
                  ],
                  [
                     8.2672119140625,
                     34.65128519895413
                  ],
                  [
                     8.2342529296875,
                     34.687427949314845
                  ],
                  [
                     8.316650390625,
                     34.73709847578162
                  ],
                  [
                     8.250732421875,
                     34.908457853981375
                  ],
                  [
                     8.3001708984375,
                     34.95799531086792
                  ],
                  [
                     8.41552734375,
                     35.160336728130346
                  ],
                  [
                     8.459472656249998,
                     35.24113278166642
                  ],
                  [
                     8.316650390625,
                     35.285984736065764
                  ],
                  [
                     8.32763671875,
                     35.420391545750746
                  ],
                  [
                     8.37158203125,
                     35.460669951495305
                  ],
                  [
                     8.3441162109375,
                     35.67068501330236
                  ],
                  [
                     8.2562255859375,
                     35.737595151747826
                  ],
                  [
                     8.2562255859375,
                     35.92909271208457
                  ],
                  [
                     8.316650390625,
                     36.075742215627
                  ],
                  [
                     8.3331298828125,
                     36.12012758978146
                  ],
                  [
                     8.3111572265625,
                     36.16005298551354
                  ],
                  [
                     8.360595703125,
                     36.25756282630298
                  ],
                  [
                     8.3331298828125,
                     36.28413532741724
                  ],
                  [
                     8.3880615234375,
                     36.31512514748051
                  ],
                  [
                     8.3935546875,
                     36.421282443649496
                  ],
                  [
                     8.184814453125,
                     36.461054075054314
                  ],
                  [
                     8.1683349609375,
                     36.50963615733049
                  ],
                  [
                     8.3331298828125,
                     36.59347887826919
                  ],
                  [
                     8.4429931640625,
                     36.619936625629215
                  ],
                  [
                     8.4649658203125,
                     36.70365959719456
                  ],
                  [
                     8.4429931640625,
                     36.752089156946326
                  ],
                  [
                     8.5638427734375,
                     36.78289206199065
                  ],
                  [
                     8.646240234375,
                     36.82247761166621
                  ],
                  [
                     8.6627197265625,
                     36.84446074079564
                  ],
                  [
                     8.646240234375,
                     36.9367208722872
                  ]
               ]
            ]
         }
      }
   ]
}
var lat = 36.75;
var lng = 3.05;
var zoom = 8;

var map = new L.Map('map');

var osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
var osmAttrib = 'Map data &copy; OpenStreetMap contributors';
var osm = new L.TileLayer(osmUrl, { minZoom: 5, maxZoom: 10, attribution: osmAttrib });
map.addLayer(osm);

map.setView(new L.LatLng(lat, lng), zoom);

// transform geojson coordinates into an array of L.LatLng
var coordinates = dz.features[0].geometry.coordinates[0];
var latLngs = [];
for (i = 0; i < coordinates.length; i++) {
   latLngs.push(new L.LatLng(coordinates[i][1], coordinates[i][0]));
}

L.mask(latLngs).addTo(map);
// map.on('click', addMarker);
var circle = L.circle([lat, lng], 6000).addTo(map);

function moveableMarker(map, marker) {
   function trackCursor(evt) {
      marker.setLatLng(evt.latlng)
   }

   marker.on("mousedown", () => {
      map.dragging.disable()
      map.on("mousemove", trackCursor)
   })

   marker.on("mouseup", () => {
      map.dragging.enable()
      map.off("mousemove", trackCursor)
      var center = circle.getBounds().getCenter()
      document.getElementById('lat').value = center.lat;
      document.getElementById('lng').value = center.lng;

   })

   return marker
}

const moveable = moveableMarker(map, circle);


// map.on('mouseup', function (e) {
//    map.removeEventListener('mousemove');
// })

setTimeout(() => {
   map.invalidateSize();
}, 2000);

function addMarker(e) {
   // Add marker to map at click location; add popup window
   var newMarker = new L.marker(e.latlng).addTo(map);
}